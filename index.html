<!DOCTYPE html>
<head>
	<meta charset="UTF-8" />
	<title>数字 Suuji: Japanese Numbers</title>
	<meta name="description" content="A simple flashcard app for practicing spoken japanese numbers." />
	<meta name="author" content="Chris Langtiw" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <!--
    <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Averia+Sans+Libre:700' />
	<link href="style.css" rel="stylesheet" type="text/css" />
	-->
	<style type="text/css">
	/* reset box model */
	*, *:before, *:after {
	  -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;
	 }

 	html, body, #wrapper, .page { height: 100%; } /* set up full height layout */

	body {
		background: #ccc;
		margin: 0;
		padding: 0;
	}

	#wrapper {
		/* background: #FFE678; */
		overflow-x: hidden;
		position: relative;
		border: 3px solid #08210A;
}

	#wrapper > header,
	#wrapper > footer
	{
		position: fixed;
		padding: 1px 0;
		width: 100%;
		z-index: 100;
	}

	#wrapper > header { 
		top: 0;
		height: 50px;
		/* background: #f00; */
		background: rgba(15,66,20,0.8);
		padding: 10px;
	}

	#wrapper > footer { 
		bottom: 0;
		font-size: 85%;
		height: 50px;
		/* background: #0f0; */
		background: rgba(15,66,20,0.8);
		color: #efefef;
		padding: 1px 1em;
	}

	.page {
		padding: 50px 1%;
		/* background: rgba(255,255,255,0.2); */
		background: url(img/tatami1.jpg);
		position: absolute;
		width: 100%;
		-webkit-transform: translate3d(100%, 0, 0);
		transform: translate3d(100%, 0, 0);
		-webkit-transition-duration: 0.25s;
		transition-duration: 0.25s;
		border: 1px solid #08210A;
	}

	.ib { display: inline-block; }

	#wrapper .page.open { 
		-webkit-transform: translate3d(0, 0, 0); 
		transform: translate3d(0, 0, 0); 
	}

	#wrapper > header nav { 
		float: right; 
	}

	#wrapper > header nav img { 
		width: 30px; 
	}

	#wrapper > footer nav { display: none; }

	.page {

	}

	.question, .answer {
		padding: 1px 0;
		height: 50%;
		position: relative;
		background: inherit;
	}

	.question {
		z-index: 2;
	}

	.answer {
		z-index: 1;
		/*
		-webkit-transform: translate3d(0, -100%, 0); 
		transform: translate3d(0, -100%, 0); 
		*/
		-webkit-transform: rotateX(90deg);
		transform: rotateX(90deg);
	}

	.answer.reveal {
		/*
		-webkit-transform: translate3d(0, 0, 0); 
		transform: translate3d(0, 0, 0); 
		*/
		-webkit-transform: rotateX(0deg);
		transform: rotateX(0deg);
	}

	.centertext { text-align: center; }
	.leftalign { float: left; }
	#wrapper > header .leftalign { float: none; position: absolute; left: 0; }
	.rightalign { float: right; }
	.clear { clear: both; }

	.ui-1 { display: inline-block; width: 75%; }
	.ui-2 { display: inline-block; width: 45%; }
	.ui-3 { display: inline-block; width: 30%; }

	button {
		font-size: 85%;
		/*width: 48%;*/
		text-align: center;
		border: 1px solid #999;
		padding: 6px;
		border-radius: 5px;
		background: #efefef;
		font-family: Helvetica, Arial, sans-serif;

	}

	#wrapper > header button,
	#wrapper > footer button {
		height: 100%;
		top: 0;
	}

	/*** TYPOGRAPHY ***/
	body {
		font-family: Verdana, Arial, sans-serif;
		color: #000;
		font-size: 115%;
	}

	h1 { font-weight: bold; font-size: 1.7em; margin: 0.75em 0 0.25em 0; }
	h2 { font-weight: bold; font-size: 1.4em; margin: 0.5em 0 0.25em 0; }
	h3 { font-weight: bold; font-size: 1.2em; margin: 0.5em 0 0.25em 0; }

	#wrapper > header h1 {
		text-align: center;
		color: #fff;
		text-shadow: 1px 1px #333;
		margin: 0;
		font-size: 110%;
	}

	.question, .answer {
		font-size: 120%;
		text-align: center;
		padding: 1px 0;
		font-weight: normal;
	}

	p {
		margin: 0.5em 0;
	}


/*
	@media screen and (min-width: 1000px) {
		button {
			font-size: 130%;
			width: 20%;
			text-align: center;
			border: 1px solid #999;
			padding: 10px;
			border-radius: 10px;
			background: #efefef;
			font-family: Helvetica, Arial, sans-serif;
		}

		.question, .answer {
			font-size: 160%;
			text-align: center;
			padding: 1px 0;
		}

	}

	@media screen and (min-width: 600px) {
		body {
			font-family: Verdana, Arial, sans-serif;
			color: #000;
			background: #ccc;
			margin: 0;
			padding: 25px 2%;
		}

		button {
			font-size: 120%;
			width: 25%;
			text-align: center;
			border: 1px solid #999;
			padding: 10px;
			border-radius: 10px;
			background: #efefef;
			font-family: Helvetica, Arial, sans-serif;
		}

		.question, .answer {
			font-size: 160%;
			text-align: center;
			padding: 1px 0;
		}

	}
*/
	</style>

</head>
<body>
<div id="wrapper">
	<header>
		<nav class="button" data-page="menu">
			<img src="img/icon-menu.svg" onerror="this.src='img/icon-png2x.png'" />
		</nav>
		<section>
			<h1>数字　<i>Sūji</i></h1>
		</section>
	</header>

	<section id="settings" class="page">
		<form id="settingsform" action="#" method="get">
			<h2>Question Display</h2>
			<div>
				<label>
					<input type="radio" name="showK" value="0" checked />
					<span>Arabic Numerals</span>
				</label>
			</div>
			<div>
				<label>
					<input type="radio" name="showK" value="1" />
					<span>Kanji Numerals</span>
				</label>
			</div>
			<h2>Answer Display</h2>
			<!--
			<div>
				<label>
					<input type="checkbox" name="showH" value="1" checked />
					<span>Show Hiragana</span>
				</label>
			</div>
			-->
			<div>
				<label>
					<input type="checkbox" name="showR" value="1" checked />
					<span>Show Romaji (Hiragana is always shown)</span>
				</label>
			</div>
		</form>
	</section>

	<section id="about" class="page">
		<h1>About</h1>
		<p>Author: Chris Langtiw <a href="http://www.sitebabble.com">www.sitebabble.com</a></p>
		<p>Version: 0.2.0</p>
	</section>

	<section id="stats" class="page">
		<h1>Stats</h1>
	</section>

	<section id="menu" class="page showbuttons">
		<h1>Menu</h1>
		<div class="centertext">
			<p><button data-page="settings" class="ui-1">Settings</button></p>
			<p><button data-page="about" class="ui-1">About</button></p>
			<p><button data-page="stats" class="ui-1">View Stats</button></p>
		</div>
	</section>

	<section id="game" class="page">
		<div class="question">
			<p>Question Content</p>
		</div>

		<div class="answer">
			<p>Answer Content</p>
		</div>
	</section>

	<section id="home" class="page open centertext">
		<!--<h2>Numbers</h2>-->
		<button data-gamestart="numbers" class="ui-1"><h2>Numbers</h2>Numbers presented in Kanji or Arabic numerals</button>

		<!--<h2>Dates</h2>-->
		<button data-gamestart="dates" class="ui-1"><h2>Dates</h2>Dates presented as weekday, month, day</button>

		<!--<h2>Time</h2>-->
		<button data-gamestart="times" class="ui-1"><h2>Times</h2>Presented in hours and minutes in 12-hour format</button>
	</section>

	<footer class="centertext"></footer>
</div><!-- wrapper -->

<script type="text/javascript" src="lib/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="lib/jquery.mobile-events.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

	////////////////////////////
	//////////// APP ///////////
	////////////////////////////

	/****
		Set up controller App
		This is mostly a container for holding the general App functionality,
		such as showing pages and handling the auto back button functionality.
		There's also a top-level button handler that launches the games, changes
		pages and stuff.

		Note that when a non-game page is shown, to initiate preprocessing of the
		page simply add a method to App named after the page id with the suffix 
		_before attached. The method will be called before displaying the page.
		Likewise, a method with the suffix _after attached to the page id will 
		be called when the back button is pressed.

		When the data-action attribute is attached to a button, App.buttonHandler 
		will either hand off the event to any running game's buttonHandler or 
		to an App method of the same name as the action.
	 **/
	var App = {};

	/*
		Show a page. Also create a back button in the header automatically.

		Note that currently you shouldn't reopen pages already open because it
		doesn't manage history.
	 */
	App.showPage = function(page) {
		// bail if we're trying to open the currently open page
		if ($header.children(':first-child').attr('data-back') == page) return;

		$pages
			.filter('#' + page)
			.css('zIndex', ++currentZ)
			.addClass('open');

		// add back button to header
		//$header.prepend('<button data-back="'+ page +'" class="leftalign">Back</button>');
		$('<button />')
			.addClass('leftalign')
			.append('Back')
			.attr('data-back', page)
			.css('zIndex', (100 + currentZ))
			.prependTo($header);

	}; // showPage

	/****
		Hide the topmost page
	 **/
	App.pageBack = function(page) {
		$pages
			.filter('#' + page)
			.removeClass('open')
			.css('zIndex', --currentZ);

		// remove the first back button if present
		var $fc = $header.children(':first-child');
		if (typeof $fc.attr('data-back') != 'undefined') $fc.remove();

		// save data
		window.localStorage.setItem( AppID, JSON.stringify(data) );
		
	}; // pageBack


	/****
		Set up general button handler
		This primary handler manages the basic page opening and back button 
		functionality, as well as calling the init methods of the game objects.
		Any other triggered events are then passed on to the running game object's
		button handler. 
	 **/
	App.buttonHandler = function(e) {
		//console.log('buttonHandler called on',this);

		var $this = $(this);

		switch(true) {
			// check if gamestart present
			case typeof $this.attr('data-gamestart') != 'undefined':
				// show game page
				App.showPage('game');
				// launch game
				GameController.games[$this.attr('data-gamestart')].init();
			break;

			// display requested page 
			case typeof $this.attr('data-page') != 'undefined':
				// Handle page preprocessing
				// if there's a method name in App named after the page call it first
				if (typeof App[$this.attr('data-page') + '_before'] == 'function')
					App[$this.attr('data-page') + '_before']();
				
				// display page
				App.showPage($this.attr('data-page'));
			break;

			// back button
			case typeof $this.attr('data-back') != 'undefined':
				// Handle page postprocessing
				// if there's a method name in App named after the page call it first
				if (typeof App[$this.attr('data-back') + '_after'] == 'function')
					App[$this.attr('data-back') + '_after']();
				
				// close page
				App.pageBack($this.attr('data-back'));

				// if a game is running the game's end method should be called
				// IF the back button is the game page
				if (typeof GameController.running != 'undefined' && $this.attr('data-back') == 'game')
					GameController.games[GameController.running].gameEnd();

			break;

			// otherwise hand off to running game buttonHandler or App method
			default:
				if (typeof GameController.running != 'undefined')
					GameController.games[GameController.running].buttonHandler(e, $this);
				else if (typeof App[$this.attr('data-action')] == 'function')
					App[$this.attr('data-action')](e, $this);
			break;
		}

	}; // buttonHandler

	/****
		Settings page preprocessor - called prior to displaying the page
		Updates form settings 
	 **/
	App.settings_before = function() {
		
		var $pageInputs = $pages.filter('#settings').find(':input');

		// update form on page to reflect current settings before showing page
		// first, remove all checked properties
		$pageInputs
			.removeProp('checked');

		// ...then reset them

		// hiragana is always shown
		//if (data.settings.showH) {
		//	$pageInputs
		//		.find('[name=showH]')
		//		.prop('checked');
		//}
		
		if (data.settings.showR) {
			$pageInputs
				.filter('[name=showR]')
				.prop('checked',true);
		}

		$pageInputs
			.filter('[name=showK]')
			.filter('[value='+(data.settings.showK ? '1': '0')+']')
			.prop('checked', true);

	}; // App.settings_before

	/****
		Settings page preprocessor - called prior to displaying the page
		Extracts the form data and saves it into the data object.
	 **/
	App.settings_after = function() {
		var $page = $pages.filter('#settings');

		// because the value of showK can be undefined (if the checkbox is not checked)
		// and because the val() will return text we use parseInt() and also add the || 0
		// (as in undefined || 0 => 0)
		var $tmp = $page.find(':checked');
		data.settings.showK = parseInt($tmp.filter('[name=showK]').val()) || 0;
		data.settings.showR = parseInt($tmp.filter('[name=showR]').val()) || 0;

	}; // App.settings_after

	/****
		Stats page

	 **/
	App.stats_before = function() {
		var a = parseInt(data.stats.numbers.correct / data.stats.numbers.drillCount * 100);
		a = isNaN(a) ? 0: a;

		var text = 
		'<h2>Numbers</h2>' + 
		'<p>Total cards viewed: ' + data.stats.numbers.drillCount + '<br />' +
		'Accuracy: ' + a + '%</p>';

		a = parseInt(data.stats.dates.correct / data.stats.dates.drillCount * 100);
		a = isNaN(a) ? 0: a;

		text += 
		'<h2>Dates</h2>' + 
		'<p>Total cards viewed: ' + data.stats.dates.drillCount + '<br />' +
		'Accuracy: ' + a + '%</p>';

		a = parseInt(data.stats.times.correct / data.stats.times.drillCount * 100);
		a = isNaN(a) ? 0: a;

		text += 
		'<h2>Times</h2>' + 
		'<p>Total cards viewed: ' + data.stats.times.drillCount + '<br />' +
		'Accuracy: ' + a + '%</p>';

		text += '<p class="centertext"><button data-action="resetstats" data-game="numbers" class="ui-1">Reset Stats</button></p>';
		$pages
			.filter('#stats')
			.html(text);
	}; // App.stats_before

	/****
		Action handler for resetstats button (on stats page)
		Resets stats for games
	 **/
	App.resetstats = function(e, $this) {
		data.stats = defaults.stats;
		App.stats_before();

	}; // App.resetStats

	////////////////////////////
	/////////// GAME ///////////
	////////////////////////////

	/****
		Basic Game object

	 **/
	var Game = { data: {} };

	// The number data, which corresponds to the number of places in the generated number array
	// k = Kanji, h = Hiragana, r = Romaji
	// zero is ignored because you wouldn't say the zero place
	Game.data.numbers = [
		[ // 0
			{k:'',		h:'',			r:''},
			{k:'一',		h:'いち',		r:'ichi'},
			{k:'二',		h:'に',			r:'ni'},
			{k:'三',		h:'さん',		r:'san'},
			{k:'四',		h:'よん',		r:'yon'},
			{k:'五',		h:'ご',			r:'go'},
			{k:'六',		h:'ろく',		r:'roku'},
			{k:'七',		h:'なな',		r:'nana'},
			{k:'八',		h:'はち',		r:'hachi'},
			{k:'九',		h:'きゅう',		r:'kyuu'}
		],
		[ // 00
			{k:'',		h:'',			r:''},
			{k:'十',		h:'じゅう',		r:'jyuu'},
			{k:'二十',	h:'にじゅう',		r:'nijyuu'},
			{k:'三十',	h:'さんじゅう',	r:'sanjyuu'},
			{k:'四十',	h:'よんじゅう',	r:'yonjyuu'},
			{k:'五十',	h:'ごじゅう',		r:'gojyuu'},
			{k:'六十',	h:'ろくじゅう',	r:'rokujyuu'},
			{k:'七十',	h:'ななじゅう',	r:'nanajyuu'},
			{k:'八十',	h:'はちじゅう',	r:'hachijyuu'},
			{k:'九十',	h:'きゅうじゅう',	r:'kyuujyuu'}
		],
		[ // 000
			{k:'',		h:'',			r:''},
			{k:'百',		h:'ひゃく',		r:'hyaku'},
			{k:'二百',	h:'にひゃく',		r:'nihyaku'},
			{k:'三百',	h:'さんびゃく',	r:'sanbyaku'},
			{k:'四百',	h:'よんひゃく',	r:'yonhyaku'},
			{k:'五百',	h:'ごひゃく',		r:'gohyaku'},
			{k:'六百',	h:'ろっぴゃく',	r:'roppyaku'},
			{k:'七百',	h:'ななひゃく',	r:'nanahyaku'},
			{k:'八百',	h:'はっぴゃく',	r:'happyaku'},
			{k:'九百',	h:'きゅうひゃく',	r:'kyuuhyaku'}
		],
		[ // 0000
			{k:'',		h:'',			r:''},
			{k:'千',		h:'せん',		r:'sen'},
			{k:'二千',	h:'にせん',		r:'nisen'},
			{k:'三千',	h:'さんぜん',		r:'sanzen'},
			{k:'四千',	h:'よんせん',		r:'yonsen'},
			{k:'五千',	h:'ごせん',		r:'gosen'},
			{k:'六千',	h:'ろくせん',		r:'rokusen'},
			{k:'七千',	h:'ななせん',		r:'nanasen'},
			{k:'八千',	h:'はっせん',		r:'hassen'},
			{k:'九千',	h:'きゅうせん',	r:'kyuusen'}
		],
		[ // 00000
			{k:'',		h:'',			r:''},
			{k:'万',		h:'いちま',		r:'ichiman'},
			{k:'二万',	h:'にまん',		r:'niman'},
			{k:'三万',	h:'さんまん',		r:'sanman'},
			{k:'四万',	h:'よんまん',		r:'yonman'},
			{k:'五万',	h:'ごまん',		r:'goman'},
			{k:'六万',	h:'ろくまん',		r:'rokuman'},
			{k:'七万',	h:'ななまん',		r:'nanaman'},
			{k:'八万',	h:'はちまん',		r:'hachiman'},
			{k:'九万',	h:'きゅうまん',	r:'kyuuman'}
		]
	];



	/****

	 **/
	Game.gameEnd = function() {
		GameController.running = '';

		$question.empty();
		$answer.empty();
		$footer.empty();

	}; // Game.gameEnd

	/****

	 **/
	Game.buttonHandler = function(e, $this) {
		//console.log('Game.buttonHandler called on',$this);

		switch($this.attr('data-action')) {
			case 'showanswer':
				// reveal answer
				$answer.addClass('reveal');
				// change control buttons
				$footer
					.empty()
					.append('<button class="ui-2" data-action="tallywrong">Wrong</button>')
					.append('<button class="ui-2" data-action="tallyright">Right</button>');
			break;

			case 'tallyright':
				data.stats[GameController.running].correct++;
			case 'tallywrong':
				data.stats[GameController.running].drillCount++;
				// get next card
				this.nextCard();
			break;

			default:
				// hand off to instance method
				this[$this.attr('data-action')](e, $this);
			break;
		} // switch
	}; // Game.buttonHandler

	/****
		showNextCard() - interface placeholder
	 **/
	Game.getNewCard = function() {
		// this method should be overridden by Game instances
		// or possibly set this up to be called by the instance's getNewCard method
	}; // Game.getNewCard

	/****
		nextCard() - general answer display
		Instances can override this if necessary
	 **/
	Game.nextCard = function() {

		this.getNewCard();

		$footer
			.empty()
			.append('<button class="ui-1" data-action="showanswer">Show Answer</button>');

	}; // Game.nextCard

	/****


	 **/
	Game.makeNewNumber = function() {
		// generate new number as array of places between 1 to 5 places inclusive
		// note that the array will be in reverse order (32767 -> [7,6,7,2,3])

		// determine number of places
		do {
			var places = Math.abs(Math.floor((Math.random() * 10) - 4));				
		} while (places == 0);

		var numArray = [];

		// generate random digit 0 - 9 for each place
		for (var c = 0; c < places; c++) {
			do {
				var n = Math.abs(Math.floor((Math.random() * 10) - 4));
			} while (c == (places - 1) && n == 0);

			numArray.push(n);
		}

		return numArray; // return array
	}; // Game.makeNewNumber

	/****

	 **/
	Game.generateNumber = function() {
		// generate a number. If the generated number is in the generator history regenerate
		do {
			var numArr = this.makeNewNumber();
			//var tmp = numArr.concat().reverse().join('');
		} while (numberHistory.indexOf(tmp) != -1);

		var tmp = numArr.concat().reverse().join('');

		// maintain number history and prune when limit is reached
		numberHistory.push(tmp);
		if (numberHistory.length > settings.numberLimit) numberHistory.shift();

		return this.getNumberData(numArr); // return array
	}; // Game.generateNumber


	/****

	 **/
	Game.getNumberData = function(numArr) {
		var numData = {};
		numData.src = numArr;
		numData.str = numArr.concat().reverse().join('');
		numData.qK = '';
		numData.ansR = '';
		numData.ansH = '';

		for (var c = 0; c < numArr.length; c++) {
			//numData.str = numArr[c] + numData.str; // build number string
			numData.qK = this.data.numbers[c][numArr[c]].k + numData.qK; // build kanji
			numData.ansH = this.data.numbers[c][numArr[c]].h + ' ' + numData.ansH; // build hiragana
			numData.ansR = this.data.numbers[c][numArr[c]].r + ' ' + numData.ansR; // build romaji
		}

		return numData;
	}; // Game.getNumberData

	/****
		Convert a number to an array
		Currently coded to deal with up to four decimal places
		Should auto determine number of places later
	 **/
	Game.numToArray = function(num) {
		var tmp = [];

		for (var c = 0; c < 4; c++) {
			tmp.push(Math.floor(num / Math.pow(10, c)) % 10);
		}

		return tmp;
	}

	/****
		GameController
		The GameController object simply keeps track of which game is running
		and maintains a reference to the game instance so that game methods
		can be called externally, mainly from the app buttonHandler method.
	 **/
	var GameController = {}; // init games container
	GameController.running = undefined;
	GameController.games = [];


	////////////////////////////
	///////// NUMBERS //////////
	////////////////////////////

	var Numbers = Object.create(Game);
	// register game with GameController
	GameController.games['numbers'] = Numbers;
	
	/****

	 **/
	Numbers.init = function() {
		GameController.running = 'numbers';

		this.nextCard();


	}; // Numbers.init

	/****

	 **/
	Numbers.getNewCard = function() {
		//var numData = this.getNumberData();
		var numData = this.generateNumber();

		var text = data.settings.showK ? 
			'<article>' + numData.qK + '</article>' : 
			'<article>' + numData.str + '</article>';

		$question
			.empty()
			.append(text)
			.show();

		text = '<p class="hiragana">' + numData.ansH + '</p>';
		if (data.settings.showR) text += '<p class="romaji">' + numData.ansR + '</p>';

		$answer
			.empty()
			.removeClass('reveal')
			.append(text);


	}; // Numbers.getNewCard




	////////////////////////////
	////////// DATES ///////////
	////////////////////////////

	var Dates = Object.create(Game);
	// register game with GameController
	GameController.games['dates'] = Dates;
	
	/****

	 **/
	Dates.init = function() {
		GameController.running = 'dates';

		this.nextCard();


	}; // games.numbers.init

	/****

	 **/
	Dates.getNewCard = function() {
		var text = '<h2>これは　何月　何日　何曜日　ですか：</h2>';

		// generate new date
		var dateData = this.getDateData();
		//console.log(dateData);

		// build 

		var text = text + (data.settings.showK ? 
			'<article>' + dateData.qK + '</article>' : 
			'<article>' + dateData.str + '</article>');


		$question
			.empty()
			.append(text)
			.show();

		text = '<p class="kanji">' + dateData.ansK + '</p>';
		text = '<p class="hiragana">' + dateData.ansH + '</p>';
		if (data.settings.showR) text += '<p class="romaji">' + dateData.ansR + '</p>';

		$answer
			.empty()
			.removeClass('reveal')
			.append(text);


	}; // Dates.getNewCard

	/****

	 **/
	Dates.getNewDate = function() {

		return new Date(Math.random() * 1000000000000);

	}; // Dates.getNewDate

	/****

	 **/
	Dates.getDateData = function() {

		var dateVal = this.getNewDate();

		var dateData = {};
		dateData.src = dateVal;
		dateData.str = dateVal.toDateString();
		
		// japanese date format is commonly year month day weekday
		dateData.qK = 
			dateVal.getFullYear() + '年 ' + 
			(dateVal.getMonth() + 1) + '月 ' + 
			dateVal.getDate() + '日 ' + 
			this.data.datetime.weekday[dateVal.getDay()].k;

		
		//console.log(this.numToArray(dateVal.getFullYear()));

		// set up year
		var tmp = this.getNumberData(this.numToArray(dateVal.getFullYear()));
		dateData.ansH = tmp.ansH + 'とし';
		dateData.ansR = tmp.ansR + 'toshi';

		// set up month
		if (typeof this.data.datetime.month[dateVal.getMonth()] != 'undefined') {
			dateData.ansH += ' ' + this.data.datetime.month[dateVal.getMonth()].h;
			dateData.ansR += ' ' + this.data.datetime.month[dateVal.getMonth()].r;
		} else {
			tmp = this.getNumberData(this.numToArray(dateVal.getMonth() + 1));
			dateData.ansH += tmp.ansH + 'がつ';
			dateData.ansR += tmp.ansR + 'gatsu';
		}

		// set up day
		if (typeof this.data.datetime.day[dateVal.getDate()] != 'undefined') {
			dateData.ansH += ' ' + this.data.datetime.day[dateVal.getDate()].h;
			dateData.ansR += ' ' + this.data.datetime.day[dateVal.getDate()].r;
		} else {
			tmp = this.getNumberData(this.numToArray(dateVal.getDate()));
			dateData.ansH += tmp.ansH + 'にち';
			dateData.ansR += tmp.ansR + 'nichi';
		}

		// add weekday
		dateData.ansH += ' ' + this.data.datetime.weekday[dateVal.getDay()].h;
		dateData.ansR += ' ' + this.data.datetime.weekday[dateVal.getDay()].r;

		return dateData;

	}; // Dates.getDateData

	/****
		The following data tables are exception based. If the target number
		is in the exception list, use the exception given, otherwise use 
		the standard number and suffix.　The Kanji versions all use arabic
		numerals plus the standard kanji, so no kanji is given below.
	 **/
	Dates.data.datetime = {
		month: { // 月　がつ　gatsu
			'3':  {k:'',		h:'よがつ',			r:'yogatsu'},		// 4
			'6':  {k:'',		h:'しちがつ',			r:'shichigatsu'},	// 7
			'8':  {k:'',		h:'くがつ',			r:'kugatsu'}		// 9
		},

		day: { // 日　にち　nichi
			'1':  {k:'',		h:'ついたち',			r:'tsuitachi'},		// 1
			'2':  {k:'',		h:'ふつか',			r:'futsuka'},		// 2
			'3':  {k:'',		h:'みっか',			r:'mikka'},			// 3
			'4':  {k:'',		h:'よっか',			r:'yokka'},			// 4
			'5':  {k:'',		h:'いつか',			r:'itsuka'},		// 5
			'6':  {k:'',		h:'むいか',			r:'muika'},			// 6
			'7':  {k:'',		h:'なのか',			r:'nanoka'},		// 7
			'8':  {k:'',		h:'ようか',			r:'youka'},			// 8
			'9':  {k:'',		h:'ここのか',			r:'kokonoka'},		// 9
			'10': {k:'',		h:'とおか',			r:'tooka'},			// 10
			'14': {k:'',		h:'じゅうよっか',		r:'jyuuyokka'},		// 14
			'20': {k:'',		h:'はつか',			r:'hatsuka'},		// 20
			'24': {k:'',		h:'にじゅうよっか',	r:'nijyuuyokka'}	// 24
		},

		weekday: [
			{k:'日曜日',		h:'にちようび',		r:'nichiyoubi', 	e:'Sunday'}, 	// Sun
			{k:'月曜日',		h:'げつようび',		r:'getsuyoubi', 	e:'Monday'}, 	// Mon
			{k:'火曜日',		h:'かようび',			r:'kayoubi', 		e:'Tuesday'}, 	// Tue
			{k:'水曜日',		h:'すいようび',		r:'suiyoubi', 		e:'Wednesday'}, // Wed
			{k:'木曜日',		h:'もくようび',		r:'mokuyoubi', 		e:'Thursday'}, 	// Thu
			{k:'金曜日',		h:'きにょうび',		r:'kinyoubi', 		e:'Friday'}, 	// Fri
			{k:'土曜日',		h:'どようび',			r:'doyoubi', 		e:'Saturday'} 	// Sat
		]
	};


	////////////////////////////
	////////// TIMES ///////////
	////////////////////////////

	var Times = Object.create(Game);
	// register game with GameController
	GameController.games['times'] = Times;
	
	/****

	 **/
	Times.init = function() {
		GameController.running = 'times';

		this.nextCard();


	}; // Times.init

	/****

		Ok, instead of a table I'm gonna try writing the logic directly for the 
		hours and minutes.

		hours = 時 ji
		minutes = 分 fun/pun

		hours and minutes exceptions
		4 = yo; 7 = shichi; 9 = ku
		
		minutes additional exceptions
		1, 3, 4, 6, 8, 10(0) uses pun instead of fun
		1, 6, 8, 10(0) written as -ppun
		30 uses han (half-past)
		other numbers are standard
	 **/
	Times.getNewCard = function() {

		var text = '<h2>これは何時ですか：</h2>';



	}; // Times.getNewCard




	////////////////////////////
	///////// APP INIT /////////
	////////////////////////////

	var AppID = 'com.cll-suuji.app'; // ideally should match id parameter in config.xml for consistency

	var defaults = {
		version: '0.3.0',
		stats: {
			numbers: {
				drillCount: 0,
				correct: 0,
				accuracy: 0
			},
			dates: {
				drillCount: 0,
				correct: 0,
				accuracy: 0
			},
			times: {
				drillCount: 0,
				correct: 0,
				accuracy: 0
			}
		},
		settings: {
			numberLimit: 	25, // track generated number history to avoid duplicates within set limit
			showK: 			0,  // display Kanji in question
			//showH: 			1,  // display hiragana answer
			showR: 			1	// display romaji answer
		}
	}

	// initialize general data object
	var data = {};

	// initialize localStorage
	if (typeof window.Storage == 'undefined') {
		// no localStorage object available; create the object
		window.localStorage = {};
		data = $.extend({}, defaults);
	} else {
		// localStorage available, initialize or retrieve data
		if (typeof window.localStorage[AppID] != 'undefined') {
			data = JSON.parse(window.localStorage.getItem(AppID));
		} else {
			// first time running app, init app data property
			data = $.extend({}, defaults);
			window.localStorage.setItem( AppID, JSON.stringify(data) );
		} // catch

		// check data structure version and update if necessary
		// yes, this is currently destructive and existing data is lost
		if (typeof data.version == 'undefined' || data.version != '0.3.0') {
			data = $.extend({}, defaults);
			window.localStorage.setItem( AppID, JSON.stringify(data) );
		}

	} // else


	var $header = $('#wrapper > header');
	var $footer = $('#wrapper > footer');

	var $pages = $('.page'); // container for all pages

	var $question = $('.question');
	var $answer = $('.answer');

	var currentZ = 10; // track z-index of displayed panels

	var numberHistory = []; // array for tracking last x generated numbers, where x = settings.numberLimit



	/*
	// intialize Hammer library
	// ref: http://hammerjs.github.io/
	var hMgr = new Hammer(document.body, {});

	// set up tap listener
	hMgr.on('tap', buttonHandler);
	*/

	// set up jQuery Mobile Events plugin
	// ref: https://github.com/benmajor/jQuery-Mobile-Events
	$(document.body)
		.on(
			'tap',
			'button, .button',
			App.buttonHandler
		 );


}); // document.ready

// cleanup method to avoid memory leaks
window.onunload = function() { $(document.body).remove(); };

</script>

</body>
</html>